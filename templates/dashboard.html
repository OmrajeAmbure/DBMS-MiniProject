{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>Dashboard</h2>
      <div>
        <span class="me-3">Signed in as <strong>{{ username }}</strong> ({{ role }})</span>
      </div>
    </div>
    <div class="row g-3">
      <div class="col-md-4">
        <div class="card p-3">
          <h5>Total Students</h5>
          <div id="total-students">—</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card p-3">
          <h5>Admins</h5>
          <div id="total-admins">—</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card p-3">
          <h5>Users</h5>
          <div id="total-users">—</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
async function loadStats() {
  const res = await fetch('/api/stats', { credentials: 'same-origin' });
  if (!res.ok) return;
  const { total_students, total_admins, total_users } = await res.json();

  document.getElementById('total-students').innerText = total_students;
  document.getElementById('total-admins').innerText = total_admins;
  document.getElementById('total-users').innerText = total_users;
}
loadStats();
</script>
{% endblock %}